---
title: "load_pilot_data"
author: "ML"
date: "10/02/2021"
output:
  html_document:
    toc: yes
    toc_float: yes
    theme: united
  pdf_document:
    toc: yes
---

## Project title   
Add here   

### Project Description   
Add here   

### Project Setup  
Load packages, set global code chunk parameters.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("googlesheets4")
library(googlesheets4)
library(tidyverse)
library(kableExtra)
library(here)
```

## Load pilot data from GoogleSheet
Pilot data is stored at:
https://docs.google.com/spreadsheets/d/1cbmYDfIc2dxHJxBaowojUZZkN31NW4sL_pHw0t9eTTU/edit#gid=0

```{r load pilot data, echo=FALSE}
#pdata <- read_sheet("https://docs.google.com/spreadsheets/d/1cbmYDfIc2dxHJxBaowojUZZkN31NW4sL_pHw0t9eTTU/edit#gid=0", range = "Data_extraction", skip=1) #loads some of the mixed-type columns as lists
fishdata <- read_sheet("https://docs.google.com/spreadsheets/d/1cbmYDfIc2dxHJxBaowojUZZkN31NW4sL_pHw0t9eTTU/edit#gid=477880397", range = "Data_extraction_2", skip=1, col_types = "ccnccccccncncccccnncccnnnnccnncncnccnnncncncccccccc") #with specifying column types
dim(fishdata)
#610  48
names(fishdata)
#View(fishdata)
str(fishdata)
```
###Remove PFOS_Total rows and fishcake
```{r check pilot data loading, echo=FALSE}

fishdata_2 <- fishdata %>% filter(!PFAS_type == 'PFOS_Total')

fishdata_3 <- fishdata_2 %>% filter(!Species_common == 'Fish cake')

dim(fishdata_3)
#512  47

write.csv(fishdata_3, here("data", "pilot_data_preprocessed.csv"), row.names = F)

fishdata_3 <- read.csv(here("data", "pilot_data_preprocessed.csv"))

```


###Check content of columns (upper/lower case etc.)
```{r check pilot data loading, echo=FALSE}

fishdata_3 %>% distinct(Study_ID)

fishdata_3 %>% distinct(Country_firstAuthor)

fishdata_3 %>% distinct(PFAS_type)

fishdata_3 %>% distinct(PFAS_carbon_chain)

fishdata_3 %>% distinct(Cooking_method)

fishdata_3 %>% distinct(Cooking_Category)

fishdata_3 %>% distinct(Oil_type)

fishdata_3 %>% distinct(Unit_PFAS_conc)

fishdata_3 %>% distinct(Effect_ID)

fishdata_3 %>% distinct(Cohort_ID)

fishdata_3 %>% distinct(Sc_technical_biological)

fishdata_3 %>% distinct(Se_technical_biological)

fishdata_3 %>% distinct(Unit_LOD_LOQ)

fishdata_3 %>% distinct(Raw_data_provided)

fishdata_3 %>% distinct(Invertebrate_vertebrate)

fishdata_3 %>% distinct(Fish_mollusc)

fishdata_3 %>% distinct(Moisture_loss_in_percent)

Species_Scientific <- fishdata_3 %>% distinct(Species_Scientific)

#csv-file for phylogenetic tree
write.csv(Species_Scientific, "Species_Scientific.csv", row.names = F)

```

###Check content of individual studies
```{r check pilot data loading, echo=FALSE}

#Bhavsar_2014
Bhavsar_2014 <- fishdata_3 %>% filter (Study_ID == "F003")

Bhavsar_2014  %>% distinct(Species_Scientific)
Bhavsar_2014  %>% distinct(PFAS_type)
Bhavsar_2014  %>% distinct(Cohort_ID)
Bhavsar_2014  %>% distinct(Effect_ID)
Bhavsar_2014  %>% distinct(Cooking_Category)
Bhavsar_2014  %>% distinct(Cooking_method)

Bhavsar_2014_salmon <- Bhavsar_2014 %>% filter (Species_Scientific == "Oncorhynchus tshawytscha") 

Bhavsar_2014_salmon  %>% distinct(PFAS_type)
Bhavsar_2014_salmon  %>% distinct(Cohort_ID)
Bhavsar_2014_salmon  %>% distinct(Effect_ID)

Bhavsar_2014_carp <- Bhavsar_2014 %>% filter (Species_Scientific == "Cyprinus carpio")

Bhavsar_2014_carp  %>% distinct(PFAS_type)
Bhavsar_2014_carp  %>% distinct(Cohort_ID)
Bhavsar_2014_carp  %>% distinct(Effect_ID)


Bhavsar_2014_Salvelinus <- Bhavsar_2014 %>% filter (Species_Scientific == "Salvelinus namaycush")

Bhavsar_2014_Salvelinus  %>% distinct(Cohort_ID)
Bhavsar_2014_Salvelinus  %>% distinct(Effect_ID)

Bhavsar_2014_Sander <- Bhavsar_2014 %>% filter (Species_Scientific == "Sander vitreus")

Bhavsar_2014_Sander  %>% distinct(Cohort_ID)
Bhavsar_2014_Sander  %>% distinct(Effect_ID)

#Barbosa_2018
Barbosa_2018 <- fishdata_3 %>% filter (Study_ID == "F002")

Barbosa_2018  %>% distinct(Species_Scientific)
Barbosa_2018  %>% distinct(PFAS_type)
Barbosa_2018  %>% distinct(Cohort_ID)
Barbosa_2018  %>% distinct(Effect_ID)
Barbosa_2018  %>% distinct(Cooking_Category)
Barbosa_2018  %>% distinct(Cooking_method)

#Alves_2017
Alves_2017 <- fishdata_3 %>% filter (Study_ID == "F001")

Alves_2017  %>% distinct(Species_Scientific)
Alves_2017  %>% distinct(PFAS_type)
Alves_2017  %>% distinct(Cohort_ID)
Alves_2017  %>% distinct(Effect_ID)
Alves_2017  %>% distinct(Cooking_Category)
Alves_2017  %>% distinct(Cooking_method)

#DelGobbo_2008
DelGobbo_2008 <- fishdata_3 %>% filter (Study_ID == "F005")

DelGobbo_2008  %>% distinct(Species_Scientific)
DelGobbo_2008  %>% distinct(PFAS_type)
DelGobbo_2008  %>% distinct(Cohort_ID)
DelGobbo_2008  %>% distinct(Effect_ID)
DelGobbo_2008  %>% distinct(Cooking_Category)
DelGobbo_2008  %>% distinct(Cooking_method)

DelGobbo_2008_Ictalurus <- DelGobbo_2008 %>% filter (Species_Scientific == "Ictalurus punctatus") 

DelGobbo_2008_Ictalurus  %>% distinct(Cohort_ID)
DelGobbo_2008_Ictalurus  %>% distinct(Effect_ID)

DelGobbo_2008_Epinephelus <- DelGobbo_2008 %>% filter (Species_Scientific == "Epinephelus itajara") 
DelGobbo_2008_Epinephelus  %>% distinct(Cohort_ID)
DelGobbo_2008_Epinephelus  %>% distinct(Effect_ID)

DelGobbo_2008_Lophius <- DelGobbo_2008 %>% filter (Species_Scientific == "Lophius americanus") 
DelGobbo_2008_Lophius  %>% distinct(Cohort_ID)
DelGobbo_2008_Lophius  %>% distinct(Effect_ID)

DelGobbo_2008_Bathypolypus <- DelGobbo_2008 %>% filter (Species_Scientific == "Bathypolypus arcticus") 
DelGobbo_2008_Bathypolypus  %>% distinct(Cohort_ID)
DelGobbo_2008_Bathypolypus  %>% distinct(Effect_ID)

DelGobbo_2008_Lutjanus <- DelGobbo_2008 %>% filter (Species_Scientific == "Lutjanus campechanus") 
DelGobbo_2008_Lutjanus  %>% distinct(Cohort_ID)
DelGobbo_2008_Lutjanus  %>% distinct(Effect_ID)

DelGobbo_2008_Diplosoma <- DelGobbo_2008 %>% filter (Species_Scientific == "Diplosoma listerianum") 
DelGobbo_2008_Diplosoma  %>% distinct(Cohort_ID)
DelGobbo_2008_Diplosoma  %>% distinct(Effect_ID)

DelGobbo_2008_Amblyraja <- DelGobbo_2008 %>% filter (Species_Scientific == "Amblyraja hyperborea") 
DelGobbo_2008_Amblyraja  %>% distinct(Cohort_ID)
DelGobbo_2008_Amblyraja  %>% distinct(Effect_ID)

DelGobbo_2008_Larimichthys <- DelGobbo_2008 %>% filter (Species_Scientific == "Larimichthys polyactis") 
DelGobbo_2008_Larimichthys  %>% distinct(Cohort_ID)
DelGobbo_2008_Larimichthys  %>% distinct(Effect_ID)

#Hu_2020
Hu_2020 <- fishdata_3 %>% filter (Study_ID == "F006")

Hu_2020  %>% distinct(Species_Scientific)
Hu_2020  %>% distinct(PFAS_type)
Hu_2020  %>% distinct(Cohort_ID)
Hu_2020  %>% distinct(Effect_ID)
Hu_2020  %>% distinct(Cooking_Category)
Hu_2020  %>% distinct(Cooking_method)

#Kim_2020
Kim_2020 <- fishdata_3 %>% filter (Study_ID == "F007")

Kim_2020  %>% distinct(Species_Scientific)
Kim_2020  %>% distinct(PFAS_type)
Kim_2020  %>% distinct(Cohort_ID)
Kim_2020  %>% distinct(Effect_ID)
Kim_2020  %>% distinct(Cooking_Category)
Kim_2020  %>% distinct(Cooking_method)

#Luo_2019
Luo_2019 <- fishdata_3 %>% filter (Study_ID == "F008")

Luo_2019  %>% distinct(Species_Scientific)
Luo_2019  %>% distinct(PFAS_type)
Luo_2019  %>% distinct(Cohort_ID)
Luo_2019  %>% distinct(Effect_ID)
Luo_2019  %>% distinct(Cooking_Category)
Luo_2019  %>% distinct(Cooking_method)

#Sungur_2019
Sungur_2019 <- fishdata_3 %>% filter (Study_ID == "F010")

Sungur_2019  %>% distinct(Species_Scientific)
Sungur_2019  %>% distinct(PFAS_type)
Sungur_2019  %>% distinct(Cohort_ID)
Sungur_2019  %>% distinct(Effect_ID)
Sungur_2019  %>% distinct(Cooking_Category)
Sungur_2019  %>% distinct(Cooking_method)

Sungur_2019_Pomatomus <- Sungur_2019 %>% filter (Species_Scientific == "Pomatomus saltator")
Sungur_2019_Pomatomus  %>% distinct(Cohort_ID)
Sungur_2019_Pomatomus  %>% distinct(Effect_ID)

Sungur_2019_Mullus <- Sungur_2019 %>% filter (Species_Scientific == "Mullus barbatus")
Sungur_2019_Mullus  %>% distinct(Cohort_ID)
Sungur_2019_Mullus  %>% distinct(Effect_ID)

Sungur_2019_Salmo <- Sungur_2019 %>% filter (Species_Scientific == "Salmo trutta")
Sungur_2019_Salmo  %>% distinct(Cohort_ID)
Sungur_2019_Salmo  %>% distinct(Effect_ID)

Sungur_2019_Pagellus <- Sungur_2019 %>% filter (Species_Scientific == "Pagellus erythrinus")
Sungur_2019_Pagellus  %>% distinct(Cohort_ID)
Sungur_2019_Pagellus  %>% distinct(Effect_ID)

Sungur_2019_Mugil <- Sungur_2019 %>% filter (Species_Scientific == "Mugil cephalus")
Sungur_2019_Mugil  %>% distinct(Cohort_ID)
Sungur_2019_Mugil  %>% distinct(Effect_ID)

Sungur_2019_Scomber <- Sungur_2019 %>% filter (Species_Scientific == "Scomber scombrus")
Sungur_2019_Scomber  %>% distinct(Cohort_ID)
Sungur_2019_Scomber  %>% distinct(Effect_ID)

Sungur_2019_Dicentrarchus <- Sungur_2019 %>% filter (Species_Scientific == "Dicentrarchus labrax")
Sungur_2019_Dicentrarchus  %>% distinct(Cohort_ID)
Sungur_2019_Dicentrarchus  %>% distinct(Effect_ID)

Sungur_2019_Scomber <- Sungur_2019 %>% filter (Species_Scientific == "Scomber scombrus")
Sungur_2019_Scomber  %>% distinct(Cohort_ID)
Sungur_2019_Scomber  %>% distinct(Effect_ID)

Sungur_2019_Atherina <- Sungur_2019 %>% filter (Species_Scientific == "Atherina hepsetus")
Sungur_2019_Atherina  %>% distinct(Cohort_ID)
Sungur_2019_Atherina  %>% distinct(Effect_ID)

#Taylor_2019
Taylor_2019 <- fishdata_3 %>% filter (Study_ID == "F011")

Taylor_2019  %>% distinct(Species_Scientific)
Taylor_2019  %>% distinct(PFAS_type)
Taylor_2019  %>% distinct(Cohort_ID)
Taylor_2019  %>% distinct(Effect_ID)
Taylor_2019  %>% distinct(Cooking_Category)
Taylor_2019  %>% distinct(Cooking_method)

Taylor_2019_Platycephalus <- fishdata_3 %>% filter (Species_Scientific == "Platycephalus fuscus")
Taylor_2019_Platycephalus  %>% distinct(Cohort_ID)
Taylor_2019_Platycephalus  %>% distinct(Effect_ID)

Taylor_2019_Portunus <- fishdata_3 %>% filter (Species_Scientific == "Portunus armatus")
Taylor_2019_Portunus  %>% distinct(Cohort_ID)
Taylor_2019_Portunus  %>% distinct(Effect_ID)

Taylor_2019_Metapenaeus <- fishdata_3 %>% filter (Species_Scientific == "Metapenaeus macleayi")
Taylor_2019_Metapenaeus  %>% distinct(Cohort_ID)
Taylor_2019_Metapenaeus  %>% distinct(Effect_ID)

#Vassiliadou_2015
Vassiliadou_2015 <- fishdata_3 %>% filter (Study_ID == "F013")

Vassiliadou_2015  %>% distinct(PFAS_type)
Vassiliadou_2015  %>% distinct(Cohort_ID)
Vassiliadou_2015  %>% distinct(Effect_ID)
Vassiliadou_2015  %>% distinct(Cooking_Category)
Vassiliadou_2015  %>% distinct(Species_Scientific)
Vassiliadou_2015  %>% distinct(Cooking_method)

Vassiliadou_2015_Engraulis <- Vassiliadou_2015 %>% filter (Species_Scientific == "Engraulis encrasicolus")
Vassiliadou_2015_Engraulis  %>% distinct(Cohort_ID)
Vassiliadou_2015_Engraulis  %>% distinct(Effect_ID)

Vassiliadou_2015_Boops <- Vassiliadou_2015 %>% filter (Species_Scientific == "Boops boops")
Vassiliadou_2015_Boops  %>% distinct(Cohort_ID)
Vassiliadou_2015_Boops  %>% distinct(Effect_ID)

Vassiliadou_2015_Merluccius <- Vassiliadou_2015 %>% filter (Species_Scientific == "Merluccius merluccius")
Vassiliadou_2015_Merluccius  %>% distinct(Cohort_ID)
Vassiliadou_2015_Merluccius  %>% distinct(Effect_ID)

Vassiliadou_2015_Spicara <- Vassiliadou_2015 %>% filter (Species_Scientific == "Spicara smaris")
Vassiliadou_2015_Spicara  %>% distinct(Cohort_ID)
Vassiliadou_2015_Spicara  %>% distinct(Effect_ID)

Vassiliadou_2015_Atherina <- Vassiliadou_2015 %>% filter (Species_Scientific == "Atherina boyeri")
Vassiliadou_2015_Atherina  %>% distinct(Cohort_ID)
Vassiliadou_2015_Atherina  %>% distinct(Effect_ID)

Vassiliadou_2015_Sardina <- Vassiliadou_2015 %>% filter (Species_Scientific == "Sardina pilchardus")
Vassiliadou_2015_Sardina  %>% distinct(Cohort_ID)
Vassiliadou_2015_Sardina  %>% distinct(Effect_ID)

Vassiliadou_2015_Mullus <- Vassiliadou_2015 %>% filter (Species_Scientific == "Mullus barbatus")
Vassiliadou_2015_Mullus  %>% distinct(Cohort_ID)
Vassiliadou_2015_Mullus  %>% distinct(Effect_ID)

Vassiliadou_2015_Parapenaeus <- Vassiliadou_2015 %>% filter (Species_Scientific == "Parapenaeus longirostris")
Vassiliadou_2015_Parapenaeus  %>% distinct(Cohort_ID)
Vassiliadou_2015_Parapenaeus  %>% distinct(Effect_ID)

Vassiliadou_2015_Loligo <- Vassiliadou_2015 %>% filter (Species_Scientific == "Loligo vulgaris")
Vassiliadou_2015_Loligo  %>% distinct(Cohort_ID)
Vassiliadou_2015_Loligo  %>% distinct(Effect_ID)



```

```{r check pilot data loading, echo=FALSE}

#some simple descriptive plots and tables
hist(fishdata$Publication_year)
hist(fishdata$Mc, breaks=20)
hist(fishdata$Me, breaks=20)

table(fishdata$PFAS_type)
table(fishdata$PFAS_type)

table(fishdata$Species_common)
table(fishdata$Pooled_Nc...31)
table(fishdata$"Se/sd") #570 SD and 40 NA

#checking for missing values
is.na(fishdata$Mc) #0 missing values
table(is.na(fishdata$Mc))

table(is.na(fishdata$Me)) #0 missing values

table(is.na(fishdata$Sc)) #53 missing values
table(is.na(fishdata$Se)) #55 missing values

table(is.na(fishdata$Nc)) #0 missing values
table(is.na(fishdata$Ne)) #0 missing values

table(is.na(fishdata$PFAS_carbon_chain))

table(is.na(fishdata$Temperature_in_Celsius)) #6 missing values: Kim_2020 didn't provide temperature for grilling

table(is.na(fishdata$Length_cooking_time_in_s)) #56 missing values: Vassiliadou_2015 didn't provide temperature 

is.na(fishdata$Volume_liquid_ml)
table(is.na(fishdata$Volume_liquid_ml)) #133 missing values: No data for Alves_2017, Barbosa_2018, Hu_2020 (Steaming), etc.



```

### Moderators {.tabset .tabset-fade .tabset-pills}

#### PFAS type by paper with k (number of effect sizes)
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$PFAS_type)
#20

fishdata_3 %>% distinct(PFAS_type)

fishdata_3 %>% count(PFAS_type)

fishdata_3 %>% count(PFAS_type,Study_ID) %>% count(Study_ID)

table_PFAS_type <- fishdata_3 %>%
  group_by(PFAS_type) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_PFAS_type %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))

table_PFAS_type %>%
  pivot_longer(cols = c(n_effect_sizes, n_studies),
               names_to = 'n_type') %>%
ggplot() +
  geom_bar(stat = 'identity',
           aes(x = PFAS_type,
               y = value,
               fill = n_type),
           position=position_dodge()) +
  coord_flip()
```

#### PFAS_carbon_chain
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$PFAS_carbon_chain)
#12

fishdata_3 %>% distinct(PFAS_carbon_chain)

fishdata_3 %>% count(PFAS_carbon_chain)

fishdata_3 %>% count(PFAS_carbon_chain,Study_ID) %>% count(Study_ID)

table_PFAS_chain <- fishdata_3 %>%
  group_by(PFAS_carbon_chain) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(PFAS_carbon_chain))

table_PFAS_chain %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))

table_PFAS_type %>%
  pivot_longer(cols = c(n_effect_sizes, n_studies),
               names_to = 'n_type') %>%
ggplot() +
  geom_bar(stat = 'identity',
           aes(x = PFAS_carbon_chain,
               y = value,
               fill = n_type),
           position=position_dodge()) +
  coord_flip()

chain <- fishdata_3 %>% filter(!is.na(PFAS_carbon_chain))

mean(chain$PFAS_carbon_chain)

range(chain$PFAS_carbon_chain)
```

#### Choice_of_9
```{r echo=FALSE, message=FALSE, warning=FALSE}

fishdata_3 %>% distinct(Choice_of_9)

fishdata_3 %>% count(Choice_of_9)

table_Choice_of_9 <- fishdata_3 %>%
  group_by(Choice_of_9) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_Choice_of_9 %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))
```

#### Cooking_method
```{r echo=FALSE, message=FALSE, warning=FALSE}

Cooking_methods <- unique(fishdata_3$Cooking_method)
#9

fishdata_3 %>% distinct(Cooking_method)

fishdata_3 %>% count(Cooking_method)

table_Cooking_method <- fishdata_3 %>%
  group_by(Cooking_method) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_Cooking_method %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))

fishdata_2 %>%
  group_by(Cooking_method) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes)) %>%
  pivot_longer(cols = c(n_effect_sizes, n_studies),
               names_to = 'n_type') %>%
ggplot() +
  geom_bar(stat = 'identity',
           aes(x = Cooking_method,
               y = value,
               fill = n_type),
           position=position_dodge())
```

#### Cooking_Category
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$Cooking_Category)

fishdata_3 %>% distinct(Cooking_Category)

fishdata_3 %>% count(Cooking_Category)

table_Cooking_Category <- fishdata_3 %>%
  group_by(Cooking_Category) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_Cooking_Category %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))

fishdata_2 %>%
  group_by(Cooking_Category) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes)) %>%
  pivot_longer(cols = c(n_effect_sizes, n_studies),
               names_to = 'n_type') %>%
ggplot() +
  geom_bar(stat = 'identity',
           aes(x = Cooking_Category,
               y = value,
               fill = n_type),
           position=position_dodge())
```

#### Species_Scientific
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$Species_Scientific)
#40

fishdata_3 %>% distinct(Species_Scientific)

fishdata_3 %>% count(Species_Scientific)

table_Species_Scientific <- fishdata_3 %>%
  group_by(Species_Scientific) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_Species_Scientific %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))

```

#### Invertebrate_vertebrate
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$Invertebrate_vertebrate)

fishdata_3 %>% distinct(Invertebrate_vertebrate)

fishdata_3 %>% count(Invertebrate_vertebrate)

table_Invertebrate_vertebrate <- fishdata_3 %>%
  group_by(Invertebrate_vertebrate) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_Invertebrate_vertebrate %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))

```

#### Fish_mollusc
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$Fish_mollusc)

fishdata_3 %>% distinct(Fish_mollusc)

fishdata_3 %>% count(Fish_mollusc)

table_Fish_mollusc <- fishdata_3 %>%
  group_by(Fish_mollusc) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_Fish_mollusc %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))

```


#### Species_common
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique($Species_common)
#39

fishdata_3 %>% distinct(Species_common)

fishdata_3 %>% count(Species_common)

table_Species_common <- fishdata_2 %>%
  group_by(Species_common) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_Species_common %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))
```

#### Temperature_in_Celsius
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$Temperature_in_Celsius)
#13

fishdata_3 %>% distinct(Temperature_in_Celsius)

table_Temperature_in_Celsius <- fishdata_3 %>%
  group_by(Temperature_in_Celsius) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_Temperature_in_Celsius_2 <- fishdata_3 %>%
  group_by(Temperature_in_Celsius) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(Temperature_in_Celsius))

temp <- fishdata_3 %>% filter(!is.na(Temperature_in_Celsius))

mean(temp$Temperature_in_Celsius)

range(temp$Temperature_in_Celsius)

table_Temperature_in_Celsius %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))

table_Temperature_in_Celsius_2 %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))
```

#### Length_cooking_time_in_s
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$Length_cooking_time_in_s)
#17

fishdata_3 %>% distinct(Length_cooking_time_in_s)

table_Length_cooking_time_in_s <- fishdata_3 %>%
  group_by(Length_cooking_time_in_s) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

fishdata_3 %>%
  group_by(Length_cooking_time_in_s) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(Length_cooking_time_in_s))

fish <- fishdata_3 %>% filter(!is.na(Length_cooking_time_in_s))

mean(fish$Length_cooking_time_in_s)

range((fish$Length_cooking_time_in_s))

table_Length_cooking_time_in_s %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))
```

#### Oil_type
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$Oil_type)
#7

fishdata_3 %>% distinct(Oil_type)

table_Oil_type <- fishdata_3 %>%
  group_by(Oil_type) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_Oil_type %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))

fishdata_3 %>%
  group_by(Oil_type) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes)) %>%
  pivot_longer(cols = c(n_effect_sizes, n_studies),
               names_to = 'n_type') %>%
ggplot() +
  geom_bar(stat = 'identity',
           aes(x = Oil_type,
               y = value,
               fill = n_type),
           position=position_dodge())


```

#### Volume_liquid_ml
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$Volume_liquid_ml)

fishdata_3 %>% distinct(Volume_liquid_ml)

table_Volume_liquid_ml <- fishdata_3 %>%
  group_by(Volume_liquid_ml, Oil) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(n_effect_sizes))

table_Volume_liquid_ml_2 <- fishdata_3 %>%
  group_by(Volume_liquid_ml, Oil) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(desc(Volume_liquid_ml))

volume <- fishdata_3 %>% filter(!is.na(Volume_liquid_ml))

###Oil only
fishdata_3_oil <- fishdata_3 %>% filter(Cooking_Category == 'oil-based')

#View(fishdata_3_oil)
dim(fishdata_3_oil)

mean(fishdata_3_oil$Volume_liquid_ml)
#154.297

range(fishdata_3_oil$Volume_liquid_ml)
#5 750

###water only
fishdata_3_water <- fishdata_3 %>% filter(Cooking_Category == 'water-based')

dim(fishdata_3_water)
#140  48

fishdata_3_water_2 <- fishdata_3 %>% filter(Volume_liquid_ml != NA)
dim(fishdata_3_water_2)


#View(fishdata_3_water)
dim(fishdata_3_water)

mean(fishdata_3_water$Volume_liquid_ml)
#154.297

range(fishdata_3_water$Volume_liquid_ml)
#5 750

#####

mean(fishdata_3$Volume_liquid_ml)

range(fishdata_3$Volume_liquid_ml)

table_Volume_liquid_ml %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))

table_Volume_liquid_ml_2 %>%
  kbl() %>%
  kable_styling(full_width = F, bootstrap_options = c("striped"))
```

#### Ratio cooking liquid/seafood
```{r echo=FALSE, message=FALSE, warning=FALSE}

unique(fishdata_3$Ratio_liquid_fish)

ratio <- fishdata_3 %>% filter(!is.na(Ratio_liquid_fish))
names(ratio)

ratio_2 <- ratio[,c(21,25)]
range(ratio_2$Ratio_liquid_fish)
#0.00265861 45.33091568

#Oil only
ratio_oil <- ratio_2 %>% filter(Oil == 'Yes')

range(ratio_oil$Ratio_liquid_fish)
#0.00265861 30.00000000

mean(ratio_oil$Ratio_liquid_fish)
#9.828183

#water only
ratio_water <- ratio_2 %>% filter(Oil == 'No')

range(ratio_water$Ratio_liquid_fish)
#2.50000 45.33092

mean(ratio_water$Ratio_liquid_fish)
#22.87562

```



#### Sample sizes
```{r echo=FALSE, message=FALSE, warning=FALSE}

fishdata_3 %>% distinct(Nc)

fishdata_3 %>%
  group_by(Nc) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(n_effect_sizes)

# sample size histogram
ggplot(data = fishdata_3,
       aes(x = Nc)) +
  geom_histogram()

```

#### Pooled_N
```{r echo=FALSE, message=FALSE, warning=FALSE}

fishdata_3 %>%
  group_by(Pooled_Nc) %>%
  summarize(n_effect_sizes = n(), n_studies = n_distinct(Study_ID)) %>%
  arrange(n_effect_sizes)

#Diagram doesn't work with characters in column!
### sample size histogram
#ggplot(data = fishdata,
#       aes(x = Pooled_Nc)) +
#  geom_histogram()

```

#### Overlap of 3 cooking categories?
```{r echo=FALSE, message=FALSE, warning=FALSE}

#Temperature_in_Celsius vs Cooking_Category
fishdata_3 %>%
  ggplot(aes(x=Cooking_Category, y=Temperature_in_Celsius))+
  geom_point()
  
  
#Volume_liquid_ml vs Cooking_Category
fishdata_3 %>%
  ggplot(aes(x=Cooking_Category, y=Volume_liquid_ml))+
  geom_point()

#Length_cooking_time_in_s vs Cooking_Category
fishdata_3 %>%
  ggplot(aes(x=Cooking_Category, y=Length_cooking_time_in_s))+
  geom_point()

###Correlation matrix

#Create new dataframe (with colums Cooking_Category, Temperature_in_Celsius, Volume_liquid_ml & Length_cooking_time_in_s only)

names(fishdata_2)

fishdata_2_fil <- fishdata_2[,c(13, 15,16,20)]
cor(fishdata_2_fil)

```
